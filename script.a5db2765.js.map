{"version":3,"sources":["util.js","constants.js","img.js","trapdoor.js","bullet.js","weapon.js","particle.js","enemies.js","crate.js","wall.js","firebarrel.js","bookshelf.js","script.js"],"names":["removeIf","arr","callback","i","length","splice","removeIfEq","elem","cb","a","remove","isCollidingCircle","x1","y1","r1","x2","y2","r2","Math","sqrt","isCollidingCircleEntities","b","x","width","y","height","radius","isCollidingRect","w1","h1","w2","h2","isCollidingRectEntities","entityCenter","entity","TILE_SIZE","images","imageProm","img","Promise","resolve","reject","addEventListener","loadImageNow","src","Image","loadImage","window","push","openTexture","require","closedTexture","Trapdoor","constructor","open","draw","c","drawImage","Bullet","vector","tag","speed","update","game","obstacle","obstacles","bullets","player","respawn","enemies","enemy","isColliding","kill","fillStyle","fillRect","gunTexture","Weapon","loaded","weapon","texture","Particle","vy","vx","size","color","floor","random","particles","Enemy","_game","centerX","centerY","particle","calculateCollisions","canvas","cracheadTexture","Crachead","dist","direction_vector","obs","gunguyTexture","GuyThatShootsYou","reload","weapons","crateTexture","Crate","wallTexture","Wall","barrelTexture","FireBarrel","bookshelfTexture","Bookshelf","document","getElementById","getContext","imageSmoothingEnabled","win","PUNCH_COOL_DOWN","playerFront","playerFrontWalking","playerBack","playerRightWalking","playerLeftWalking","Player","maxSpeed","punchCoolDown","keydown","LEFT","RIGHT","UP","DOWN","newObstacles","levels","currentLevel","entranceX","entranceY","shouldPickUp","left","right","up","down","calculateCursorCoords","punch","cursorX","cursorY","shoot","calculateVector","xDist","yDist","ratio","e","playerX","playerY","offsetX","offsetY","code","mouseX","mouseY","distance","event","fist","gun","drawCursor","endscreenImage","prespeed","beginPath","arc","PI","fill","requestAnimationFrame","Gamestate","layout","forEach","row","type","console","error","loop","setTimeout","_","f","w","t","h","g","titleImage","explainImage","startGame","all","then","titleImgLoaded","startImage","listener","explainImgLoaded","removeEventListener"],"mappings":"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","file":"script.a5db2765.js","sourceRoot":"..","sourcesContent":["export function removeIf(arr, callback) {\n  var i = 0;\n  while (i < arr.length) {\n    if (callback(arr[i], i)) {\n      arr.splice(i, 1);\n    } else {\n      ++i;\n    }\n  }\n}\n\nexport function removeIfEq(arr, elem, cb) {\n  removeIf(arr, a => {\n    const remove = a === elem;\n    if (remove && cb) cb();\n    return remove;\n  });\n}\n\nexport const isCollidingCircle = (x1, y1, r1, x2, y2, r2) =>\n  Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2) <= r1 + r2;\n\nexport const isCollidingCircleEntities = (a, b) =>\n  isCollidingCircle(\n    a.x + a.width / 2,\n    a.y + a.height / 2,\n    a.radius,\n    b.x + b.width / 2,\n    b.y + b.height / 2,\n    b.radius\n  );\n\nexport const isCollidingRect = (x1, y1, w1, h1, x2, y2, w2, h2) =>\n  x1 + w1 > x2 && y1 + h1 > y2 && x1 < x2 + w2 && y1 < y2 + h2;\n\nexport const isCollidingRectEntities = (a, b) =>\n  isCollidingRect(a.x, a.y, a.width, a.height, b.x, b.y, b.width, b.height);\n\nexport const entityCenter = entity => [\n  entity.x + entity.width / 2,\n  entity.y + entity.height / 2\n];\n","export const TILE_SIZE = 42;\n","export const images = [];\n\nconst imageProm = img =>\n  new Promise((resolve, reject) => {\n    img.addEventListener(\"load\", () => resolve(img));\n    img.addEventListener(\"error\", () => reject());\n  });\n\nexport function loadImageNow(src) {\n  const img = new Image();\n  img.src = src;\n  return imageProm(img);\n}\n\nexport function loadImage(src) {\n  const img = new Image();\n  img.src = \"data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=\";\n  // once everything on the page is loaded and ready we can start loading assets\n  window.addEventListener(\"load\", () => {\n    img.src = src;\n    images.push(imageProm(img));\n  });\n  return img;\n}\n","import { TILE_SIZE } from \"./constants.js\";\nimport { loadImage } from \"./img.js\";\n\nconst openTexture = loadImage(require(\"./art/trapdooropen.png\"));\nconst closedTexture = loadImage(require(\"./art/trapdoorclosed.png\"));\n\nexport class Trapdoor {\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n    this.height = TILE_SIZE;\n    this.width = TILE_SIZE;\n    this.open = false;\n  }\n\n  draw(c) {\n    if (this.open) {\n      c.drawImage(openTexture, this.x, this.y, this.height, this.width);\n    } else {\n      c.drawImage(closedTexture, this.x, this.y, this.height, this.width);\n    }\n  }\n}\n","import {\n  isCollidingCircleEntities,\n  removeIf,\n  isCollidingRectEntities,\n  removeIfEq\n} from \"./util.js\";\n\nimport { Trapdoor } from \"./trapdoor.js\";\n\nexport class Bullet {\n  constructor(x, y, vector, tag) {\n    this.x = x;\n    this.y = y;\n    this.radius = 2;\n    this.width = 4;\n    this.height = 4;\n    this.vector = vector;\n    this.speed = 10;\n    this.tag = tag;\n  }\n\n  update(game) {\n    this.x += this.vector[0] * this.speed;\n    this.y += this.vector[1] * this.speed;\n    for (const obstacle of game.obstacles) {\n      if (\n        !(obstacle instanceof Trapdoor) &&\n        isCollidingRectEntities(this, obstacle)\n      ) {\n        removeIfEq(game.bullets, this);\n        return;\n      }\n    }\n\n    if (this.tag == \"enemy\") {\n      if (isCollidingCircleEntities(this, game.player)) {\n        game.player.respawn();\n      }\n    }\n    if (this.tag == \"player\") {\n      removeIf(game.enemies, enemy => {\n        const isColliding = isCollidingCircleEntities(this, enemy);\n        if (isColliding) {\n          enemy.kill(game);\n          removeIfEq(game.bullets, this);\n        }\n        return isColliding;\n      });\n    }\n  }\n\n  draw(c) {\n    c.fillStyle = \"grey\";\n    c.fillRect(this.x, this.y, this.width, this.height);\n  }\n}\n","import { loadImage } from \"./img.js\";\n\nconst gunTexture = loadImage(require(\"./art/itsthegun.png\"));\n\nexport class Weapon {\n  constructor(x, y, loaded, weapon = \"gun\") {\n    this.x = x;\n    this.y = y;\n    this.loaded = loaded;\n    this.height = 4;\n    this.width = 16;\n    this.radius = 8;\n    this.texture = gunTexture;\n    this.weapon = weapon;\n  }\n\n  draw(c) {\n    c.drawImage(this.texture, this.x, this.y, this.width, this.height);\n    if (this.loaded) {\n      c.fillStyle = \"rgba(0, 0, 0, .5)\";\n      c.fillRect(this.x - 6, this.y - 6, 12, 12);\n    }\n  }\n}\n","import { removeIfEq } from \"./util.js\";\n\nexport class Particle {\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n\n    this.vy = 2.5;\n    this.vx = 0;\n    this.size = 5;\n    this.color =\n      \"rgba(\" + (Math.floor(Math.random() * 100) + 155) + \", 50, 30, 1)\";\n  }\n\n  draw(c) {\n    c.fillStyle = this.color;\n    c.fillRect(this.x, this.y, this.size, this.size);\n  }\n  update(game) {\n    this.vx = Math.random() * 4 - 2;\n    this.vy = Math.random() + 2;\n    this.size -= Math.random() / 5;\n\n    if (this.size <= 0) {\n      removeIfEq(game.particles, this);\n      return;\n    }\n\n    this.x += this.vx;\n    this.y += this.vy;\n  }\n}\n","import { Bullet } from \"./bullet.js\";\nimport { Trapdoor } from \"./trapdoor.js\";\nimport {\n  isCollidingRectEntities,\n  entityCenter,\n  isCollidingCircleEntities\n} from \"./util.js\";\nimport { Weapon } from \"./weapon.js\";\nimport { Particle } from \"./particle.js\";\nimport { loadImage } from \"./img.js\";\n\nexport class Enemy {\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n    this.width = 32;\n    this.height = 32;\n    this.radius = 16;\n    this.texture = null;\n  }\n\n  update(_game) {}\n\n  kill(game) {\n    const [centerX, centerY] = entityCenter(this);\n    const particle = () => {\n      game.particles.push(\n        new Particle(\n          centerX + (Math.random() - 1) * this.width,\n          centerY + (Math.random() - 1) * this.height\n        )\n      );\n    };\n    particle();\n    particle();\n    particle();\n    particle();\n    particle();\n    particle();\n  }\n\n  draw(c) {\n    c.drawImage(this.texture, this.x, this.y, this.width, this.height);\n    //c.fillStyle = \"brown\";\n    //c.fillRect(this.x, this.y, this.width, this.height);\n  }\n\n  calculateCollisions() {\n    if (this.y < 0) {\n      this.y = 0;\n      this.vy = 0;\n    }\n    if (this.y + this.height > canvas.height) {\n      this.y = canvas.height - this.height;\n      this.vy = 0;\n    }\n    if (this.x < 0) {\n      this.x = 0;\n      this.vx = 0;\n    }\n    if (this.x + this.width > canvas.width) {\n      this.x = canvas.width - this.width;\n      this.vx = 0;\n    }\n  }\n}\n\nconst cracheadTexture = loadImage(require(\"./art/crackhead.png\"));\n\nexport class Crachead extends Enemy {\n  constructor(x, y) {\n    super(x, y);\n    this.texture = cracheadTexture;\n  }\n\n  update(game) {\n    var dist = Math.sqrt(\n      (game.player.x - this.x) ** 2 + (game.player.y - this.y) ** 2\n    );\n    var direction_vector = [\n      (game.player.x - this.x) / dist,\n      (game.player.y - this.y) / dist\n    ];\n\n    this.x += direction_vector[0] * 4;\n\n    for (const obs of game.obstacles) {\n      if (!(obs instanceof Trapdoor) && isCollidingRectEntities(this, obs)) {\n        this.x -= direction_vector[0] * 4;\n        this.vx = 0;\n      }\n    }\n\n    this.y += direction_vector[1] * 4;\n\n    for (const obs of game.obstacles) {\n      if (!(obs instanceof Trapdoor) && isCollidingRectEntities(this, obs)) {\n        this.y -= direction_vector[1] * 4;\n        this.vy = 0;\n      }\n    }\n\n    if (isCollidingCircleEntities(this, game.player)) {\n      game.player.respawn();\n    }\n  }\n}\n\nconst gunguyTexture = loadImage(require(\"./art/gunguy.png\"));\n\nexport class GuyThatShootsYou extends Enemy {\n  constructor(x, y) {\n    super(x, y);\n    this.texture = gunguyTexture;\n    this.reload = 10;\n  }\n\n  kill(game) {\n    const [centerX, centerY] = entityCenter(this);\n    game.weapons.push(\n      new Weapon(centerX - this.width / 4, centerY - this.height / 4, true)\n    );\n    super.kill(game);\n  }\n\n  update(game) {\n    this.reload -= 1;\n    var dist = Math.sqrt(\n      (game.player.x - this.x) ** 2 + (game.player.y - this.y) ** 2\n    );\n    var direction_vector = [\n      (game.player.x - this.x) / dist,\n      (game.player.y - this.y) / dist\n    ];\n    if (this.reload <= 0) {\n      game.bullets.push(\n        new Bullet(\n          this.x + this.width / 2,\n          this.y + this.height / 2,\n          direction_vector,\n          \"enemy\"\n        )\n      );\n      this.reload = 25;\n    }\n  }\n}\n","import { TILE_SIZE } from \"./constants.js\";\nimport { loadImage } from \"./img.js\";\n\nconst crateTexture = loadImage(require(\"./art/crate.png\"));\n\nexport class Crate {\n  constructor(x, y) {\n    this.width = 3 * TILE_SIZE;\n    this.height = 3 * TILE_SIZE;\n    this.x = x;\n    this.y = y;\n    this.texture = crateTexture;\n  }\n\n  draw(c) {\n    c.drawImage(this.texture, this.x, this.y, this.width, this.height);\n  }\n}\n","import { TILE_SIZE } from \"./constants.js\";\nimport { loadImage } from \"./img.js\";\n\nconst wallTexture = loadImage(require(\"./art/wall.png\"));\n\nexport class Wall {\n  constructor(x, y) {\n    this.width = TILE_SIZE;\n    this.height = 3 * TILE_SIZE;\n    this.x = x;\n    this.y = y;\n    this.texture = wallTexture;\n  }\n\n  draw(c) {\n    c.drawImage(this.texture, this.x, this.y, this.width, this.height);\n    //c.fillStyle = \"#999\";\n    ///c.fillRect(this.x, this.y, this.width, this.height);\n  }\n}\n","import { TILE_SIZE } from \"./constants.js\";\nimport { loadImage } from \"./img.js\";\n\nconst barrelTexture = loadImage(require(\"./art/barrel.png\"));\n\nexport class FireBarrel {\n  constructor(x, y) {\n    this.width = TILE_SIZE;\n    this.height = TILE_SIZE;\n    this.x = x;\n    this.y = y;\n    this.texture = barrelTexture;\n  }\n\n  draw(c) {\n    c.drawImage(this.texture, this.x, this.y, this.width, this.height);\n    //c.fillStyle = \"orange\";\n    //c.fillRect(this.x, this.y, this.width, this.height);\n  }\n}\n","import { TILE_SIZE } from \"./constants.js\";\nimport { loadImage } from \"./img.js\";\n\nconst bookshelfTexture = loadImage(require(\"./art/bookshelf.png\"));\n\nexport class Bookshelf {\n  constructor(x, y) {\n    this.width = 4 * TILE_SIZE;\n    this.height = TILE_SIZE;\n    this.x = x;\n    this.y = y;\n    this.texture = bookshelfTexture;\n  }\n\n  draw(c) {\n    c.drawImage(this.texture, this.x, this.y, this.width, this.height);\n    //c.fillStyle = \"brown\";\n    //c.fillRect(this.x, this.y, this.width, this.height);\n  }\n}\n","import { Crachead, GuyThatShootsYou } from \"./enemies.js\";\nimport { Crate } from \"./crate.js\";\nimport { Wall } from \"./wall.js\";\nimport { FireBarrel } from \"./firebarrel.js\";\nimport { Bookshelf } from \"./bookshelf.js\";\nimport {\n  removeIf,\n  isCollidingCircle,\n  isCollidingCircleEntities,\n  isCollidingRectEntities,\n  entityCenter\n} from \"./util.js\";\nimport { Weapon } from \"./weapon.js\";\nimport { Bullet } from \"./bullet.js\";\nimport { TILE_SIZE } from \"./constants.js\";\nimport { Trapdoor } from \"./trapdoor.js\";\nimport { images, loadImageNow, loadImage } from \"./img.js\";\n\nvar canvas = document.getElementById(\"canvas\");\n/** @type {CanvasRenderingContext2D} */\nvar c = canvas.getContext(\"2d\");\n\nc.imageSmoothingEnabled = false;\n\nlet win = false;\n\nconst PUNCH_COOL_DOWN = 50;\n\nconst playerFront = loadImage(require(\"./art/frozoefront.png\"));\nconst playerFrontWalking = loadImage(require(\"./art/frozonefronttwalk.gif\"));\nconst playerBack = loadImage(require(\"./art/frozoneback.png\"));\nconst playerRightWalking = loadImage(require(\"./art/frorightwalk.gif\"));\nconst playerLeftWalking = loadImage(require(\"./art/froleftwalk.gif\"));\n\nclass Player {\n  constructor() {\n    this.x = canvas.width / 3;\n    this.y = canvas.height / 3;\n    this.vx = 0;\n    this.vy = 0;\n    this.width = 32;\n    this.height = 32;\n    this.radius = 16;\n    this.weapon = \"fist\";\n    this.maxSpeed = 4;\n    this.punchCoolDown = PUNCH_COOL_DOWN;\n    this.texture = playerFront;\n\n    this.keydown = {\n      LEFT: false,\n      RIGHT: false,\n      UP: false,\n      DOWN: false\n    };\n  }\n\n  draw() {\n    c.drawImage(this.texture, this.x, this.y, this.width, this.height);\n  }\n\n  respawn() {\n    game.enemies = [];\n    game.weapons = [];\n    game.bullets = [];\n    game.particles = [];\n    game.newObstacles(game.levels[game.currentLevel]);\n    this.x = game.entranceX;\n    this.y = game.entranceY;\n    this.vx = 0;\n    this.vy = 0;\n  }\n\n  calculateCollisions() {\n    if (this.weapon != \"gun\") {\n      removeIf(game.weapons, weapon => {\n        const shouldPickUp =\n          weapon.loaded && isCollidingCircleEntities(this, weapon);\n        if (shouldPickUp) {\n          this.weapon = weapon.weapon;\n        }\n        return shouldPickUp;\n      });\n    }\n\n    for (const obs of game.obstacles) {\n      if (obs instanceof Trapdoor) {\n        if (game.enemies.length === 0) {\n          obs.open = true;\n        }\n        if (obs.open && isCollidingRectEntities(this, obs)) {\n          game.currentLevel++;\n          if (game.currentLevel > game.levels.length - 1) {\n            win = true;\n            return;\n          }\n          game.newObstacles(game.levels[game.currentLevel]);\n          this.respawn();\n          return;\n        }\n      }\n    }\n    if (this.y < 0) {\n      this.y = 0;\n      this.vy = 0;\n    } else if (this.y + this.height > canvas.height) {\n      this.y = canvas.height - this.height;\n      this.vy = 0;\n    }\n    if (this.x < 0) {\n      this.x = 0;\n      this.vx = 0;\n    } else if (this.x + this.width > canvas.width) {\n      this.x = canvas.width - this.width;\n      this.vx = 0;\n    }\n  }\n\n  update() {\n    this.punchCoolDown++;\n\n    if (this.keydown.LEFT && !this.keydown.RIGHT) {\n      this.left();\n    } else if (this.keydown.RIGHT && !this.keydown.LEFT) {\n      this.right();\n    } else {\n      this.vx *= 0.7;\n    }\n\n    if (\n      (this.keydown.RIGHT || this.keydown.LEFT) &&\n      (this.keydown.UP || this.keydown.DOWN)\n    ) {\n      this.maxSpeed = 2.828;\n    } else {\n      this.maxSpeed = 4;\n    }\n\n    if (this.keydown.UP && !this.keydown.DOWN) {\n      this.up();\n    } else if (this.keydown.DOWN && !this.keydown.UP) {\n      this.down();\n    } else {\n      this.vy *= 0.7;\n    }\n\n    this.x += this.vx;\n\n    for (const obs of game.obstacles) {\n      if (!(obs instanceof Trapdoor) && isCollidingRectEntities(this, obs)) {\n        this.x -= this.vx;\n        this.vx = 0;\n      }\n    }\n\n    this.y += this.vy;\n\n    for (const obs of game.obstacles) {\n      if (!(obs instanceof Trapdoor) && isCollidingRectEntities(this, obs)) {\n        this.y -= this.vy;\n        this.vy = 0;\n      }\n    }\n\n    this.calculateCollisions();\n    calculateCursorCoords();\n  }\n\n  left() {\n    if (this.vx > -this.maxSpeed) {\n      this.vx -= 1;\n    } else {\n      this.vx = -this.maxSpeed;\n    }\n    this.texture = playerLeftWalking;\n  }\n\n  right() {\n    if (this.vx < this.maxSpeed) {\n      this.vx += 1;\n    } else {\n      this.vx = this.maxSpeed;\n    }\n    this.texture = playerRightWalking;\n  }\n\n  up() {\n    if (this.vy > -this.maxSpeed) {\n      this.vy -= 1;\n    } else {\n      this.vy = -this.maxSpeed;\n    }\n    this.texture = playerBack;\n  }\n\n  down() {\n    if (this.vy < this.maxSpeed) {\n      this.vy += 1;\n    } else {\n      this.vy = this.maxSpeed;\n    }\n    this.texture = playerFrontWalking;\n  }\n\n  punch() {\n    removeIf(game.enemies, enemy => {\n      const isColliding = isCollidingCircle(\n        cursorX,\n        cursorY,\n        32,\n        enemy.x,\n        enemy.y,\n        enemy.radius\n      );\n      if (isColliding) enemy.kill(game);\n      return isColliding;\n    });\n  }\n\n  shoot(vector) {\n    const [centerX, centerY] = entityCenter(this);\n    game.bullets.push(new Bullet(centerX, centerY, vector, \"player\"));\n    this.weapon = \"fist\";\n    game.weapons.push(\n      new Weapon(centerX - this.width / 4, centerY - this.height / 4, false)\n    );\n  }\n}\n\nexport function calculateVector(x1, y1, x2, y2) {\n  const xDist = x2 - x1;\n  const yDist = y2 - y1;\n  const ratio = 1 / Math.sqrt(xDist ** 2 + yDist ** 2);\n  return [xDist * ratio, yDist * ratio];\n}\n\ncanvas.addEventListener(\"click\", function(e) {\n  if (game.player.weapon === \"fist\") {\n    if (game.player.punchCoolDown > PUNCH_COOL_DOWN) {\n      game.player.punch();\n      game.player.punchCoolDown = 0;\n    }\n  } else {\n    const [playerX, playerY] = entityCenter(game.player);\n    const vector = calculateVector(playerX, playerY, e.offsetX, e.offsetY);\n    game.player.shoot(vector);\n  }\n});\n\ndocument.addEventListener(\"keydown\", function(e) {\n  switch (e.code) {\n    case \"KeyA\":\n    case \"ArrowLeft\":\n      game.player.keydown.LEFT = true;\n      break;\n\n    case \"KeyW\":\n    case \"ArrowUp\":\n      game.player.keydown.UP = true;\n      break;\n\n    case \"KeyD\":\n    case \"ArrowRight\":\n      game.player.keydown.RIGHT = true;\n      break;\n\n    case \"KeyS\":\n    case \"ArrowDown\":\n      game.player.keydown.DOWN = true;\n      break;\n\n    default:\n      return;\n  }\n});\n\ndocument.addEventListener(\"keyup\", function(e) {\n  switch (e.code) {\n    case \"KeyA\":\n    case \"ArrowLeft\":\n      game.player.keydown.LEFT = false;\n      break;\n\n    case \"KeyW\":\n    case \"ArrowUp\":\n      game.player.keydown.UP = false;\n      break;\n\n    case \"KeyD\":\n    case \"ArrowRight\":\n      game.player.keydown.RIGHT = false;\n      break;\n\n    case \"KeyS\":\n    case \"ArrowDown\":\n      game.player.keydown.DOWN = false;\n      break;\n\n    default:\n  }\n});\n\nlet cursorX = 0;\nlet cursorY = 0;\n\nfunction calculateCursorCoords() {\n  if (game.player.weapon === \"fist\") {\n    const [playerX, playerY] = entityCenter(game.player);\n    const xDist = mouseX - playerX;\n    const yDist = mouseY - playerY;\n    const distance = Math.sqrt(xDist ** 2 + yDist ** 2);\n    if (distance > 64) {\n      const ratio = 64 / distance;\n      cursorX = playerX + xDist * ratio;\n      cursorY = playerY + yDist * ratio;\n      return;\n    }\n  }\n  cursorX = mouseX;\n  cursorY = mouseY;\n}\n\nlet mouseX = 0;\nlet mouseY = 0;\n\ncanvas.addEventListener(\"mousemove\", event => {\n  mouseX = event.offsetX;\n  mouseY = event.offsetY;\n  calculateCursorCoords();\n});\n\nconst fist = loadImage(require(\"./art/itsafist.png\"));\nconst gun = loadImage(require(\"./art/itsthegun.png\"));\n/** @param {CanvasRenderingContext2D} c */\nfunction drawCursor(c) {\n  if (game.player.weapon === \"fist\") {\n    c.drawImage(fist, cursorX - 6, cursorY - 6, 12, 12);\n    if (game.player.punchCoolDown < PUNCH_COOL_DOWN) {\n      c.fillStyle = \"rgba(0, 0, 0, .5)\";\n      c.fillRect(cursorX - 6, cursorY - 6, 12, 12);\n    }\n  } else {\n    c.drawImage(gun, cursorX - 8, cursorY - 2, 16, 4);\n  }\n}\n\nconst endscreenImage = loadImage(require(\"./art/endscreen.jpg\"));\n\nfunction draw() {\n  if (win) {\n    c.drawImage(endscreenImage, 0, 0, canvas.width, canvas.height);\n    return;\n  }\n\n  game.player.update();\n\n  const prespeed =\n    Math.sqrt(\n      game.player.vx * game.player.vx + game.player.vy * game.player.vy\n    ) + 0.5;\n\n  game.speed = 120 / prespeed;\n\n  c.fillStyle = `rgba(0, 0, 0, ${(1 / game.speed) * 15})`;\n  c.fillRect(0, 0, canvas.width, canvas.height);\n\n  for (const entity of [\n    ...game.obstacles,\n    ...game.weapons,\n    ...game.enemies,\n    ...game.bullets,\n    ...game.particles\n  ]) {\n    entity.draw(c);\n  }\n\n  game.player.draw(c);\n\n  if (game.player.weapon === \"fist\") {\n    c.beginPath();\n    c.fillStyle = \"darkred\";\n    c.arc(mouseX, mouseY, 5, 0, 2 * Math.PI);\n    c.fill();\n  }\n\n  drawCursor(c);\n\n  requestAnimationFrame(draw);\n}\n\nclass Gamestate {\n  constructor() {\n    this.player = new Player();\n    this.speed = 1;\n    this.currentLevel = 0;\n    this.enemies = [];\n    this.obstacles = [];\n    this.weapons = [];\n    this.bullets = [];\n    this.particles = [];\n    this.levels = [];\n    this.entranceX = 0;\n    this.entranceY = 0;\n  }\n\n  newObstacles(layout) {\n    this.obstacles = [];\n\n    layout.forEach((row, y) => {\n      row.forEach(([type, entity], x) => {\n        switch (type) {\n          case \"noop\":\n            break;\n          case \"entrance\":\n            this.entranceX = x * TILE_SIZE;\n            this.entranceY = y * TILE_SIZE;\n            break;\n          case \"enemy\":\n            this.enemies.push(new entity(x * TILE_SIZE, y * TILE_SIZE));\n            break;\n          case \"obstacle\":\n            this.obstacles.push(new entity(x * TILE_SIZE, y * TILE_SIZE));\n            break;\n          default:\n            console.error(\"unknown map entity type:\", type);\n        }\n      });\n    });\n  }\n\n  update() {\n    for (const entity of [\n      ...this.enemies,\n      ...this.bullets,\n      ...this.particles\n    ]) {\n      if (entity.update) entity.update(game);\n    }\n  }\n  loop() {\n    if (win) return;\n    game.update();\n    setTimeout(game.loop, game.speed);\n  }\n}\n\nconst game = new Gamestate();\n\nwindow.game = game;\n\ngame.weapons.push(new Weapon(64, 64, true));\n\n{\n  // new scope so we don't accidentally use these one-off variables\n  const _ = [\"noop\"];\n  const e = [\"entrance\"];\n  const c = [\"obstacle\", Crate];\n  const b = [\"obstacle\", Bookshelf];\n  const f = [\"obstacle\", FireBarrel];\n  const w = [\"obstacle\", Wall];\n  const t = [\"obstacle\", Trapdoor];\n  const h = [\"enemy\", Crachead];\n  const g = [\"enemy\", GuyThatShootsYou];\n\n  game.levels.push(\n    [\n      [h, _, _, _, w, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, e, _, _, _, _, _, _, _],\n      [c, _, _, _, _, _, f, _, _, _, t, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, b, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _]\n    ],\n\n    [\n      [_, _, _, _, w, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, g, _, _],\n      [_, _, f, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, w, _, c, _, _, _, _, _],\n      [e, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, t],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, w, _, h, g, _, f, _, _],\n      [_, _, h, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _]\n    ],\n\n    [\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, g, _, _, _, _, _, _, _, _, g, _],\n      [_, _, c, _, _, _, _, c, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [t, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, h, h, _, _, _, _, _],\n      [_, _, _, _, _, h, h, _, _, _, _, _],\n      [_, _, c, _, _, _, _, c, _, _, _, e],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, g, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _]\n    ],\n\n    [\n      [_, _, _, _, f, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, g, _, _],\n      [_, _, _, w, b, _, _, _, _, _, _, _],\n      [_, _, h, _, _, _, _, _, _, _, _, _],\n      [e, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, w, _, _, _, h, _, _, g, _],\n      [_, _, h, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, f, _, t],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, f, _, _, _, _, _, g, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _]\n    ],\n\n    [\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, h, h, h, h, h, h, _, _, _],\n      [t, _, _, h, _, _, _, _, h, _, _, _],\n      [_, _, _, h, _, f, f, _, h, _, _, _],\n      [_, _, _, h, _, f, f, _, h, _, _, _],\n      [_, _, _, h, _, _, _, _, h, _, _, e],\n      [_, _, _, h, h, h, h, h, h, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _]\n    ],\n\n    [\n      [c, _, _, c, _, _, c, _, _, c, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [b, _, _, _, b, _, _, _, b, _, _, _],\n      [e, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, h, h, h, h, h, _, g, _],\n      [_, _, _, _, h, h, h, h, h, g, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, t],\n      [b, _, _, _, b, _, _, _, b, _, _, _],\n      [c, _, _, c, _, _, c, _, _, c, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _],\n      [_, _, _, _, _, _, _, _, _, _, _, _]\n    ]\n  );\n}\n\nconst titleImage = loadImageNow(require(\"./art/title.jpg\"));\nconst explainImage = loadImageNow(require(\"./art/explain.jpg\"));\n\ntitleImage.then(titleImgLoaded => {\n  let startImage = \"title\";\n  c.drawImage(titleImgLoaded, 0, 0, canvas.width, canvas.height);\n\n  canvas.addEventListener(\"click\", async function listener() {\n    switch (startImage) {\n      case \"title\":\n        startImage = \"explain\";\n        const explainImgLoaded = await explainImage;\n        c.drawImage(explainImgLoaded, 0, 0, canvas.width, canvas.height);\n        break;\n      case \"explain\":\n        canvas.removeEventListener(\"click\", listener);\n        await startGame();\n        break;\n    }\n  });\n});\n\nasync function startGame() {\n  await Promise.all(images);\n  requestAnimationFrame(draw);\n  game.loop();\n  game.player.respawn();\n}\n"]}